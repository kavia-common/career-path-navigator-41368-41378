{"is_source_file": true, "format": "Python", "description": "This file contains security utilities related to JWT authentication and password hashing for a backend service. It includes functions for hashing and verifying passwords with bcrypt and fallback mechanisms, as well as creating and decoding JWT tokens. The file also manages external dependencies like jose for JWT operations and passlib for bcrypt, with fallbacks if passlib is unavailable.", "external_files": ["jose", "src.core.config"], "external_methods": ["jwt.encode", "jwt.decode", "get_settings"], "published": ["hash_password", "verify_password", "create_access_token", "decode_token"], "classes": [], "methods": [{"name": "str _sha256_hex(s: str)", "description": "Returns a SHA-256 hex digest of the input string using UTF-8 encoding.", "scope": "", "scopeKind": ""}, {"name": "str _bcrypt_safe_transform(pw: str)", "description": "Prepares passwords for bcrypt hashing by pre-hashing if they exceed 72 bytes.", "scope": "", "scopeKind": ""}, {"name": "bool _is_sha256_bcrypt_tagged(hashed: str)", "description": "Detects if a bcrypt hash is tagged as pre-hashed with SHA-256.", "scope": "", "scopeKind": ""}, {"name": "str _wrap_bcrypt(hashed_core: str)", "description": "Wraps a bcrypt hash core with a scheme tag indicating pre-hashing.", "scope": "", "scopeKind": ""}, {"name": "str _unwrap_bcrypt(hashed: str)", "description": "Extracts the bcrypt hash core from a tagged bcrypt-sha256 string.", "scope": "", "scopeKind": ""}, {"name": "str hash_password(password: str)", "description": "Hashes a password securely using bcrypt, with pre-hashing for long passwords, or falls back to salted SHA-256 in dev environments.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(password: str, hashed: str)", "description": "Verifies a password against a stored hash, supporting multiple schemes and backward compatibility.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(subject: str, expires_minutes: Optional[int] = None, claims: Optional[dict[str, Any]] = None)", "description": "Creates a signed JWT access token with customizable expiration and claims.", "scope": "", "scopeKind": ""}, {"name": "dict[str,Any] decode_token(token: str)", "description": "Decodes and validates a JWT token, returning its claims.", "scope": "", "scopeKind": ""}], "calls": ["jwt.encode", "jwt.decode", "get_settings", "_bcrypt_safe_transform", "_sha256_hex", "_is_sha256_bcrypt_tagged", "_wrap_bcrypt", "_unwrap_bcrypt", "_pwd_context.hash", "_pwd_context.verify"], "search-terms": ["JWT security", "password hashing", "bcrypt with pre-hash", "JWT token creation", "JWT token decode", "fallback hashing method", "scheme tag bcrypt-sha256"], "state": 2, "file_id": 19, "knowledge_revision": 117, "git_revision": "551cc155a508653559d243a20cb82b42e9fb2e04", "revision_history": [{"39": ""}, {"83": "d817588e91a0e451b431ebba83282289df8bb429"}, {"108": "d817588e91a0e451b431ebba83282289df8bb429"}, {"117": "551cc155a508653559d243a20cb82b42e9fb2e04"}], "ctags": [{"_type": "tag", "name": "_bcrypt_safe_transform", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _bcrypt_safe_transform(pw: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(pw: str)"}, {"_type": "tag", "name": "_is_sha256_bcrypt_tagged", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _is_sha256_bcrypt_tagged(hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(hashed: str)"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _pwd_context = None$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _pwd_context: Optional[CryptContext] = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "typeref": "typename:Optional[CryptContext]", "kind": "variable"}, {"_type": "tag", "name": "_sha256_hex", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _sha256_hex(s: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(s: str)"}, {"_type": "tag", "name": "_unwrap_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _unwrap_bcrypt(hashed: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(hashed: str)"}, {"_type": "tag", "name": "_wrap_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _wrap_bcrypt(hashed_core: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(hashed_core: str)"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def create_access_token(subject: str, expires_minutes: Optional[int] = None, claims: Optional[di/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(subject: str, expires_minutes: Optional[int] = None, claims: Optional[dict[str, Any]] = None)"}, {"_type": "tag", "name": "decode_token", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def decode_token(token: str) -> dict[str, Any]:$/", "language": "Python", "typeref": "typename:dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def verify_password(password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(password: str, hashed: str)"}], "hash": "3ce4149042f6310c69d7256dd97beb5c", "format-version": 4, "code-base-name": "career_navigator_backend", "filename": "career_navigator_backend/src/security/jwt.py", "fields": [{"name": "_pwd_context = None", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[CryptContext] _pwd_context", "scope": "", "scopeKind": "", "description": "unavailable"}]}