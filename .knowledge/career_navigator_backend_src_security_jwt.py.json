{"is_source_file": true, "format": "Python", "description": "This is a Python source file containing security utilities related to JWT authentication and password hashing. It includes functions for password hashing and verification using bcrypt with fallbacks to salted SHA-256, as well as creation and decoding of JWT access tokens. The file also manages external dependencies like passlib and python-jose.", "external_files": ["src.core.config"], "external_methods": ["jwt.encode", "jwt.decode", "get_settings"], "published": ["hash_password", "verify_password", "create_access_token", "decode_token"], "classes": [], "methods": [{"name": "str hash_password(password: str)", "description": "Hashes a password securely using bcrypt, with support for pre-hashing long passwords with SHA-256 and falling back to salted SHA-256 if passlib is unavailable.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(password: str, hashed: str)", "description": "Verifies a password against a stored hash, supporting both bcrypt-based hashes (including pre-hashed variants) and legacy salted SHA-256 hashes.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(subject: str, expires_minutes: Optional[int] = None, claims: Optional[dict[str, Any]] = None)", "description": "Creates a signed JWT token for a given subject with optional expiration and additional claims.", "scope": "", "scopeKind": ""}, {"name": "dict[str,Any] decode_token(token: str)", "description": "Decodes and validates a JWT token, returning its claims.", "scope": "", "scopeKind": ""}, {"name": "str _bcrypt_safe_transform(pw: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool _is_sha256_bcrypt_tagged(hashed: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _sha256_hex(s: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _unwrap_bcrypt(hashed: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _wrap_bcrypt(hashed_core: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "get_settings", "hashlib.sha256", "hmac.compare_digest", "secrets.token_hex"], "search-terms": ["JWT security utils", "password hashing fallback", "pre-hash long passwords", "bcrypt sha256 tagging", "JWT token creation", "JWT token decode"], "state": 2, "file_id": 19, "knowledge_revision": 161, "git_revision": "4757cbc0d04963299f679eae1132d61a9bfb0203", "revision_history": [{"39": ""}, {"83": "d817588e91a0e451b431ebba83282289df8bb429"}, {"108": "d817588e91a0e451b431ebba83282289df8bb429"}, {"117": "551cc155a508653559d243a20cb82b42e9fb2e04"}, {"119": "d353b25f817886145827809a80fd014e4c51431e"}, {"161": "4757cbc0d04963299f679eae1132d61a9bfb0203"}], "ctags": [{"_type": "tag", "name": "_", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _ = getattr(passlib_bcrypt, \"__name__\", \"passlib.handlers.bcrypt\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_bcrypt_safe_transform", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _bcrypt_safe_transform(pw: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(pw: str)"}, {"_type": "tag", "name": "_is_sha256_bcrypt_tagged", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _is_sha256_bcrypt_tagged(hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(hashed: str)"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _pwd_context = CryptContext($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _pwd_context = None$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^_pwd_context: Optional[\"CryptContext\"] = None$/", "language": "Python", "typeref": "typename:Optional[\"CryptContext\"]", "kind": "variable"}, {"_type": "tag", "name": "_sha256_hex", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _sha256_hex(s: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(s: str)"}, {"_type": "tag", "name": "_unwrap_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _unwrap_bcrypt(hashed: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(hashed: str)"}, {"_type": "tag", "name": "_wrap_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _wrap_bcrypt(hashed_core: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(hashed_core: str)"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def create_access_token(subject: str, expires_minutes: Optional[int] = None, claims: Optional[di/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(subject: str, expires_minutes: Optional[int] = None, claims: Optional[dict[str, Any]] = None)"}, {"_type": "tag", "name": "decode_token", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def decode_token(token: str) -> dict[str, Any]:$/", "language": "Python", "typeref": "typename:dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "passlib_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    from passlib.handlers import bcrypt as passlib_bcrypt  # type: ignore$/", "language": "Python", "kind": "unknown", "nameref": "unknown:bcrypt"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def verify_password(password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(password: str, hashed: str)"}], "hash": "6de1d70550bc06ec625bef2f454001f5", "format-version": 4, "code-base-name": "career_navigator_backend", "filename": "career_navigator_backend/src/security/jwt.py", "fields": [{"name": "_ = getattr(passlib_bcrypt, \"__name__\", \"passlib.handlers.bcrypt\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_pwd_context = CryptContext(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_pwd_context = None", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[\"CryptContext\"] _pwd_context", "scope": "", "scopeKind": "", "description": "unavailable"}]}