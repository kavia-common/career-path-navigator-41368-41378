{"is_source_file": true, "format": "Python", "description": "This file contains security utilities for JWT authentication and password hashing, including mechanisms for hashing, verifying passwords with fallback options, and creating and decoding JWT tokens. It emphasizes the use of bcrypt with pre-hashing for long passwords, and supports a salted SHA-256 fallback.", "external_files": ["jose"], "external_methods": ["jwt.encode", "jwt.decode"], "published": ["hash_password", "verify_password", "create_access_token", "decode_token"], "classes": [], "methods": [{"name": "str hash_password(password: str)", "description": "Hash a password securely using bcrypt with optional pre-hashing for long passwords or a fallback salted SHA-256 scheme.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(password: str, hashed: str)", "description": "Verify a password against its stored hash, supporting bcrypt with pre-hashing, legacy bcrypt, or salted SHA-256.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(subject: str, expires_minutes: Optional[int] = None, claims: Optional[dict[str, Any]] = None)", "description": "Create a signed JWT token with a specified subject, expiration, and optional claims.", "scope": "", "scopeKind": ""}, {"name": "dict[str,Any] decode_token(token: str)", "description": "Decode and validate a JWT token, returning its claims.", "scope": "", "scopeKind": ""}, {"name": "str _bcrypt_safe_transform(pw: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool _is_sha256_bcrypt_tagged(hashed: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _sha256_hex(s: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _unwrap_bcrypt(hashed: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _wrap_bcrypt(hashed_core: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "get_settings", "hashlib.sha256", "hmac.compare_digest", "secrets.token_hex", "datetime.now", "timedelta", "_pwd_context.hash", "_pwd_context.verify"], "search-terms": ["JWT", "password hashing", "bcrypt fallback", "pre-hash long passwords", "token creation", "JWT decode", "passlib bcrypt", "salted SHA-256"], "state": 2, "file_id": 19, "knowledge_revision": 119, "git_revision": "d353b25f817886145827809a80fd014e4c51431e", "revision_history": [{"39": ""}, {"83": "d817588e91a0e451b431ebba83282289df8bb429"}, {"108": "d817588e91a0e451b431ebba83282289df8bb429"}, {"117": "551cc155a508653559d243a20cb82b42e9fb2e04"}, {"119": "d353b25f817886145827809a80fd014e4c51431e"}], "ctags": [{"_type": "tag", "name": "_", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _ = getattr(passlib_bcrypt, \"__all__\", None)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_bcrypt_safe_transform", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _bcrypt_safe_transform(pw: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(pw: str)"}, {"_type": "tag", "name": "_is_sha256_bcrypt_tagged", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _is_sha256_bcrypt_tagged(hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(hashed: str)"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _pwd_context = CryptContext($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    _pwd_context = None$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^_pwd_context: Optional[\"CryptContext\"] = None$/", "language": "Python", "typeref": "typename:Optional[\"CryptContext\"]", "kind": "variable"}, {"_type": "tag", "name": "_sha256_hex", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _sha256_hex(s: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(s: str)"}, {"_type": "tag", "name": "_unwrap_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _unwrap_bcrypt(hashed: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(hashed: str)"}, {"_type": "tag", "name": "_wrap_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def _wrap_bcrypt(hashed_core: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(hashed_core: str)"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def create_access_token(subject: str, expires_minutes: Optional[int] = None, claims: Optional[di/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(subject: str, expires_minutes: Optional[int] = None, claims: Optional[dict[str, Any]] = None)"}, {"_type": "tag", "name": "decode_token", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def decode_token(token: str) -> dict[str, Any]:$/", "language": "Python", "typeref": "typename:dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "passlib_bcrypt", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^    from passlib.handlers import bcrypt as passlib_bcrypt  # type: ignore$/", "language": "Python", "kind": "unknown", "nameref": "unknown:bcrypt"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/security/jwt.py", "pattern": "/^def verify_password(password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(password: str, hashed: str)"}], "hash": "89e03c4c22273f2697606f0fd53a3cb5", "format-version": 4, "code-base-name": "career_navigator_backend", "filename": "career_navigator_backend/src/security/jwt.py", "fields": [{"name": "_ = getattr(passlib_bcrypt, \"__all__\", None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_pwd_context = CryptContext(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_pwd_context = None", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[\"CryptContext\"] _pwd_context", "scope": "", "scopeKind": "", "description": "unavailable"}]}