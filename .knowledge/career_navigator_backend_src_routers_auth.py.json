{"is_source_file": true, "format": "Python", "description": "This file defines API routes for user authentication, including registration, login, and fetching current user info. It handles user data stored either in-memory or in an SQLite database, with associated functions for user management, token creation, and security. It uses FastAPI framework features like routing and dependency injection.", "external_files": ["src.core.config", "src.security.jwt", "src.models.auth", "src.db.sqlite"], "external_methods": ["get_settings", "create_access_token", "decode_token", "hash_password", "verify_password", "sqlite_db.get_conn", "sqlite_db.auth_get_user_by_email", "sqlite_db.execute", "sqlite_db.fetch_one", "sqlite_db.reset_users_table"], "published": ["router"], "classes": [{"name": "UserPublic", "description": "Pydantic model representing public user info exposed via API."}, {"name": "UserCreate", "description": "Pydantic model for user registration input."}, {"name": "UserLogin", "description": "Pydantic model for login credentials."}, {"name": "TokenResponse", "description": "Pydantic model for returning JWT token."}, {"name": "MeResponse", "description": "Pydantic model for current user info."}], "methods": [{"name": "None reset_auth_state()", "description": "Resets in-memory or SQLite-stored user data for tests or dev.", "scope": "", "scopeKind": ""}, {"name": "str _normalize_email(email: str)", "description": "Normalizes email string for consistent lookup.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict] _get_user_by_email(email: str)", "description": "Fetches user record by email from either SQLite or in-memory store.", "scope": "", "scopeKind": ""}, {"name": "Dict _create_user(email: EmailStr, full_name: Optional[str], pwd_hash: str)", "description": "Creates a new user record with hashed password and stores it.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict] _get_user_by_id(user_id: str)", "description": "Retrieves user record by user ID.", "scope": "", "scopeKind": ""}, {"name": "UserPublic _user_public(rec: Dict)", "description": "Converts internal user record to public UserPublic model.", "scope": "", "scopeKind": ""}, {"name": "UserPublic get_current_user(token: str = Depends(oauth2_scheme))", "description": "FastAPI dependency to extract current user from JWT token.", "scope": "", "scopeKind": ""}, {"name": "register(payload: UserCreate)", "description": "API endpoint to register new user with validation and password hashing.", "scope": "", "scopeKind": ""}, {"name": "login(payload: UserLogin)", "description": "API endpoint for user authentication and JWT token issuance.", "scope": "", "scopeKind": ""}, {"name": "me(current: UserPublic = Depends(get_current_user))", "description": "API endpoint to get current authenticated user info.", "scope": "", "scopeKind": ""}], "calls": ["decode_token", "create_access_token", "hash_password", "verify_password", "sqlite_db.get_conn", "sqlite_db.auth_get_user_by_email", "sqlite_db.execute", "sqlite_db.fetch_one", "get_settings", "reset_users_table"], "search-terms": ["auth routes", "JWT tokens", "SQLite user store", "OAuth2PasswordBearer", "Password hashing", "User registration", "Login endpoint", "Current user info"], "state": 2, "file_id": 26, "knowledge_revision": 139, "git_revision": "9692d709e0db253b61f3ad085d70f8e1fc3ca9aa", "revision_history": [{"53": ""}, {"80": "d817588e91a0e451b431ebba83282289df8bb429"}, {"88": "d817588e91a0e451b431ebba83282289df8bb429"}, {"89": "d817588e91a0e451b431ebba83282289df8bb429"}, {"96": "423fff8b66cd979b45e3c2984f88b886e3d4dc8d"}, {"109": "551cc155a508653559d243a20cb82b42e9fb2e04"}, {"113": "8d2fef9dcd384bf1eeea0e797e0b340f13f5780e"}, {"114": "8d2fef9dcd384bf1eeea0e797e0b340f13f5780e"}, {"121": "72618b47e137132f9e45f73caaacc7a5cea9abcb"}, {"122": "400bfc1de9abf9c3f1e28264f5359a278a2cb6b4"}, {"129": "400bfc1de9abf9c3f1e28264f5359a278a2cb6b4"}, {"135": "2661c6d7672c9073e4980e5e544b3a290195f715"}, {"139": "9692d709e0db253b61f3ad085d70f8e1fc3ca9aa"}], "ctags": [{"_type": "tag", "name": "_create_user", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def _create_user(email: EmailStr, full_name: Optional[str], pwd_hash: str) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(email: EmailStr, full_name: Optional[str], pwd_hash: str)"}, {"_type": "tag", "name": "_get_user_by_email", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def _get_user_by_email(email: str) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "function", "signature": "(email: str)"}, {"_type": "tag", "name": "_get_user_by_id", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def _get_user_by_id(user_id: str) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "function", "signature": "(user_id: str)"}, {"_type": "tag", "name": "_mem_users", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^_mem_users: Dict[str, Dict] = {}  # id -> record$/", "language": "Python", "typeref": "typename:Dict[str, Dict]", "kind": "variable"}, {"_type": "tag", "name": "_mem_users_by_email", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^_mem_users_by_email: Dict[str, str] = {}  # email -> id$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable"}, {"_type": "tag", "name": "_normalize_email", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def _normalize_email(email: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(email: str)"}, {"_type": "tag", "name": "_user_public", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def _user_public(rec: Dict) -> UserPublic:$/", "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "(rec: Dict)"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def get_current_user(token: str = Depends(oauth2_scheme)) -> UserPublic:$/", "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme))"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def login(payload: UserLogin):$/", "language": "Python", "kind": "function", "signature": "(payload: UserLogin)"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def me(current: UserPublic = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current: UserPublic = Depends(get_current_user))"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def register(payload: UserCreate):$/", "language": "Python", "kind": "function", "signature": "(payload: UserCreate)"}, {"_type": "tag", "name": "reset_auth_state", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^def reset_auth_state() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^router = APIRouter(prefix=\"\\/auth\", tags=[\"auth\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "sqlite_db", "path": "/home/kavia/workspace/code-generation/career-path-navigator-41368-41378/career_navigator_backend/src/routers/auth.py", "pattern": "/^from src.db import sqlite as sqlite_db$/", "language": "Python", "kind": "unknown", "nameref": "unknown:sqlite"}], "hash": "82487356024d998e5dec53cda48de654", "format-version": 4, "code-base-name": "career_navigator_backend", "filename": "career_navigator_backend/src/routers/auth.py", "fields": [{"name": "Dict[str, Dict] _mem_users", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, str] _mem_users_by_email", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/auth\", tags=[\"auth\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}